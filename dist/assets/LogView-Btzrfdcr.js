import{r as m,f,g as h,c as y,b as t,w as s,i as g,n as x,u as v,j as E,o as k,e as i,q as S,t as w,F as j,G as p,H as L}from"./.pnpm-CnHAC5MG.js";import{_ as T}from"./index-CMncYv_Q.js";const z={class:"log"},B={__name:"LogView",setup(D){let o=m([]);const d=m(window.innerWidth-24);f(()=>{window.addEventListener("resize",c),o.value=JSON.parse(localStorage.getItem("daylog")),console.log(o.value)}),h(()=>{window.removeEventListener("resize",c)});const c=()=>{d.value=window.innerWidth-24},_=a=>j(a).format("YYYY-MM-DD HH:mm:ss"),u=()=>{const a=o.value.map(e=>({...e,time:_(e.time),type:e.type.join(", ")})),n=p.json_to_sheet(a),l=p.book_new();p.book_append_sheet(l,n,"Sheet1"),L(l,"log_data.xlsx")};return(a,n)=>{const l=g,e=S,b=E;return k(),y("div",z,[t(l,{type:"primary",onClick:u},{default:s(()=>n[0]||(n[0]=[i("导出为 Excel")])),_:1}),t(b,{data:v(o),style:x({width:d.value+"px"})},{default:s(()=>[t(e,{prop:"time",label:"时间",width:"180"},{default:s(({row:r})=>[i(w(_(r.time)),1)]),_:1}),t(e,{prop:"book",label:"书籍",width:"80"}),t(e,{prop:"type",label:"类型",width:"80"},{default:s(({row:r})=>[i(w(r.type.join(", ")),1)]),_:1}),t(e,{prop:"score",label:"分数",width:"80"}),t(e,{prop:"cnt",label:"总数",width:"80"}),t(e,{prop:"correct",label:"正确数",width:"80"}),t(e,{prop:"error",label:"错误数",width:"80"})]),_:1},8,["data","style"])])}}},C=T(B,[["__scopeId","data-v-87fbbeff"]]);export{C as default};
